Feature: Invitation message
  
  Scenario Outline: Generate invite name
    Given secret 32 bytes passphrase <passphrase>
    And secret invite name <secretInviteName>
    When I encrypt using AES module and given passphrase
    Then the resulting encrypted <inviteName> should be <result>

  Examples:
  | secretInviteName | passphrase                       | result                   |
  | Invite 1         | 72x35FDOXugkxivh7qYlqPU91jVgy607 | OnhsB48KkRAguMJd5RklLQ== |
  | InvitE 2         | 4fKuFNOQdisWzhdup3dWRiGIV74kAdag | fkx5vRvAYbM/JBI8KpzXWw== |
  | InViTe 3         | T7TDUepNdU8wCL5ruLSy3gCcDomsbv3r | gq2UnfPHYJwOZYkanb1HVA== |

  Scenario Outline: Generate invite message body
    Given a bootstrap node url <bootstrapNode>
    And bootstrap addrress <bootstrapAddr>
    And offering registred Persona address <offeringAddr> (Rigth now only teleferic Persona is registred)
    And service announcement message SHA256 hash identifier encoded on Base64 <serviceAnnouncementMessage> (not defined yet)
    And service identifier <serviceOfferingID>
    And encrypted invite name <inviteName>
    When I compose invite message body sorting attributes alphabetically
    And format message body with Message Pack
    And encode resulting message body pack with Base64 
    Then resulting <messageBody> should be equal to <result>
  
  Examples:
  | bootstrapNode                                  | bootstrapAddr                                                              | offeringAddr                                                               | serviceAnnouncementMessage                   | serviceOfferingID | inviteName               | result |
  | https://teleferic-dev.dxmarkets.com/teleferic/ | 8MSd91xr6jSV5pS29RkV7dLeE3hDgLHJGrsyXpdSf4iitj6c75tVSNESywBzYzFEeyu5D1zyrL | 8MSd91xr6jSV5pS29RkV7dLeE3hDgLHJGrsyXpdSf4iitj6c75tVSNESywBzYzFEeyu5D1zyrL | L+ViP+UFnhc6ObWfhugqNZfE+SZkqoS46I4Qbw+NbOY= | 1                 | OnhsB48KkRAguMJd5RklLQ== | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhPbmhzQjQ4S2tSQWd1TUpkNVJrbExRPT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx |
  | https://teleferic-dev.dxmarkets.com/teleferic/ | 8MSd91xr6jSV5pS29RkV7dLeE3hDgLHJGrsyXpdSf4iitj6c75tVSNESywBzYzFEeyu5D1zyrL | 8MSd91xr6jSV5pS29RkV7dLeE3hDgLHJGrsyXpdSf4iitj6c75tVSNESywBzYzFEeyu5D1zyrL | L+ViP+UFnhc6ObWfhugqNZfE+SZkqoS46I4Qbw+NbOY= | 1                 | fkx5vRvAYbM/JBI8KpzXWw== | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhma3g1dlJ2QVliTS9KQkk4S3B6WFd3PT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx |
  | https://teleferic-dev.dxmarkets.com/teleferic/ | 8MSd91xr6jSV5pS29RkV7dLeE3hDgLHJGrsyXpdSf4iitj6c75tVSNESywBzYzFEeyu5D1zyrL | 8MSd91xr6jSV5pS29RkV7dLeE3hDgLHJGrsyXpdSf4iitj6c75tVSNESywBzYzFEeyu5D1zyrL | L+ViP+UFnhc6ObWfhugqNZfE+SZkqoS46I4Qbw+NbOY= | 1                 | gq2UnfPHYJwOZYkanb1HVA== | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhncTJVbmZQSFlKd09aWWthbmIxSFZBPT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx |

  Scenario Outline: Parse invite message body
    Given message body content <messageBody>
    When I decode message body with Base64
    And parse resulting message body with Message Pack
    Then bootstrapNode attribute should be <bootstrapNode>
    And bootstrapAddr attribute should be <bootstrapAddr>
    And offeringAddr attribute should be <offeringAddr>
    And serviceAnnouncementMessage attribute should be <serviceAnnouncementMessage>
    And serviceOfferingID attribute should be <serviceOfferingID>
    And inviteName attribute should be <inviteName>
  
  Examples:
  | bootstrapNode                                  | bootstrapAddr                                                              | offeringAddr                                                               | serviceAnnouncementMessage                   | serviceOfferingID | inviteName               | messageBody                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
  | https://teleferic-dev.dxmarkets.com/teleferic/ | 8MSd91xr6jSV5pS29RkV7dLeE3hDgLHJGrsyXpdSf4iitj6c75tVSNESywBzYzFEeyu5D1zyrL | 8MSd91xr6jSV5pS29RkV7dLeE3hDgLHJGrsyXpdSf4iitj6c75tVSNESywBzYzFEeyu5D1zyrL | L+ViP+UFnhc6ObWfhugqNZfE+SZkqoS46I4Qbw+NbOY= | 1                 | OnhsB48KkRAguMJd5RklLQ== | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhPbmhzQjQ4S2tSQWd1TUpkNVJrbExRPT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx |
  | https://teleferic-dev.dxmarkets.com/teleferic/ | 8MSd91xr6jSV5pS29RkV7dLeE3hDgLHJGrsyXpdSf4iitj6c75tVSNESywBzYzFEeyu5D1zyrL | 8MSd91xr6jSV5pS29RkV7dLeE3hDgLHJGrsyXpdSf4iitj6c75tVSNESywBzYzFEeyu5D1zyrL | L+ViP+UFnhc6ObWfhugqNZfE+SZkqoS46I4Qbw+NbOY= | 1                 | fkx5vRvAYbM/JBI8KpzXWw== | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhma3g1dlJ2QVliTS9KQkk4S3B6WFd3PT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx |
  | https://teleferic-dev.dxmarkets.com/teleferic/ | 8MSd91xr6jSV5pS29RkV7dLeE3hDgLHJGrsyXpdSf4iitj6c75tVSNESywBzYzFEeyu5D1zyrL | 8MSd91xr6jSV5pS29RkV7dLeE3hDgLHJGrsyXpdSf4iitj6c75tVSNESywBzYzFEeyu5D1zyrL | L+ViP+UFnhc6ObWfhugqNZfE+SZkqoS46I4Qbw+NbOY= | 1                 | gq2UnfPHYJwOZYkanb1HVA== | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhncTJVbmZQSFlKd09aWWthbmIxSFZBPT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx |
  

  Scenario Outline: Compose invitation message content
    Given 40 bytes random salt <dossierSalt>
    And message body type <bodyType> equal to 0 (Invitation)
    And message body content <messageBody>
    When I compose invite message content sorting attributes alphabetically
    And format message content with Message Pack
    And encrypt resulting message content pack using AES module with public passphrase "Peer Mountain"
    Then resulting <message> should be <result>

  Examples:
  | dossierSalt                                                                                                             | messageBody                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
  | 74:26:13:2f:4d:f3:f8:3e:82:ba:f3:fe:6a:dd:46:c2:00:4c:99:e8:88:ed:0f:a9:58:85:a2:11:9e:c8:b7:46:e4:f4:f0:c3:70:30:0e:17 | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhPbmhzQjQ4S2tSQWd1TUpkNVJrbExRPT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx | QgO46Himh8a5fLBmZ1ypINLAI4Fb8V/e9r0ZhqQ6A8cOlilkYfh5yMr9eRgKNXBG4HDwSX4hw7kgIqXdEXPlxYXc0yvbW+v6kFTPMeT4J+8B3+fReQTEnGTIjnHK7X9PleNlyMBpajveDPN8NgR1/Ir11nJeCmRwwvQmWg1jlXncN1aLbKiW37CXwI6J0M/obC4wfAprxPCaM9A696ohJe5mGLqBKlb97c4WTm1w5SjYuyHH4OPUVLJunKpHs5zHg6F9x6Pu2OEqSCma7OJlfy7s2n9vhpSfMNFn+HuzUkOerieF9XEkBFjW/0fSzJNVCRmXZo5dGTduG2qeeo38tAIDl8ZUXjsi1nye2sCugkvXxSXP4DlYljLK8oOwe2p+qkBxl/XlVOD3mH7/yYLCG87u7D+t3CyeBdl3NR9ltizVZCehgf9SiVwsB9JD/gPIM7L3ETF7ecXvSGUXPyLfd3MdKMmP0JDOasJ8pBlLSrA3JJ8eY/YzqyuDm2F4IQUSQ7QoX6C0z4ldxwHiAJltlqtFdwnoO1ivPYjxIBxnYnZB1BjNT0GP0c0p1QDgJPTPG+boq44Z8Sel1n0zdTTlJH1gfJQYsxHZyFKeK+mt4wydP+d2Umm3j8dW7jcFtFvYdBqPjHysUpqC1297T7A088C6CXfmwHHHDMmMS8CXQQrp7t4f6OEdIMAfrEad44GZjZwmU2nA0pr5GThFpFXPKnna27Nl79CH15qlPH9KJBpIh1QCNzaxbNi0g/O70XA7VxZP+9OWc0Dy1i0EKUUPvA== |
  | d3:11:19:a2:86:14:91:74:c7:d1:2c:10:04:59:a0:db:e5:75:e5:2c:1c:7e:9e:df:07:7c:90:8e:a0:aa:01:0b:ae:7f:b7:13:32:d3:d2:dc | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhma3g1dlJ2QVliTS9KQkk4S3B6WFd3PT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx | QgO46Himh8a5fLBmZ1ypIDakRUSvEcFXLyG2NFEDlFQI61hW2EQucs3TeleiwKQY6p+ANdHFZ6doUmvWiXV/kRidryUT4lBIrteOiD5w3FoB3+fReQTEnGTIjnHK7X9PleNlyMBpajveDPN8NgR1/Ir11nJeCmRwwvQmWg1jlXncN1aLbKiW37CXwI6J0M/obC4wfAprxPCaM9A696ohJe5mGLqBKlb97c4WTm1w5SjYuyHH4OPUVLJunKpHs5zHg6F9x6Pu2OEqSCma7OJlfy7s2n9vhpSfMNFn+HuzUkOerieF9XEkBFjW/0fSzJNVCRmXZo5dGTduG2qeeo38tAIDl8ZUXjsi1nye2sCugkvXxSXP4DlYljLK8oOwe2p+qkBxl/XlVOD3mH7/yYLCG1nMgY0N7a7S1EHGrCJrrxyfavuU9IR79j8AK3mm6ruBM7L3ETF7ecXvSGUXPyLfd3MdKMmP0JDOasJ8pBlLSrA3JJ8eY/YzqyuDm2F4IQUSQ7QoX6C0z4ldxwHiAJltlqtFdwnoO1ivPYjxIBxnYnZB1BjNT0GP0c0p1QDgJPTPG+boq44Z8Sel1n0zdTTlJH1gfJQYsxHZyFKeK+mt4wydP+d2Umm3j8dW7jcFtFvYdBqPjHysUpqC1297T7A088C6CXfmwHHHDMmMS8CXQQrp7t4f6OEdIMAfrEad44GZjZwmU2nA0pr5GThFpFXPKnna27Nl79CH15qlPH9KJBpIh1QCNzaxbNi0g/O70XA7VxZP+9OWc0Dy1i0EKUUPvA== |
  | 80:9a:a9:b7:c4:d7:0c:4a:59:45:4e:b3:d5:7e:cc:b4:58:83:cf:e4:f5:5c:1e:68:2a:d1:0e:0d:45:c6:b4:cc:71:5d:b6:0d:62:45:25:26 | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhncTJVbmZQSFlKd09aWWthbmIxSFZBPT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx | QgO46Himh8a5fLBmZ1ypIJLj+cMXKyyxXYb2n50dlNCvUPj2wJMjycLK/dGG3tFgYnqpa9zDgBySkMCKjiksoxHvBbDEau2usXXdcaPKGGUB3+fReQTEnGTIjnHK7X9PleNlyMBpajveDPN8NgR1/Ir11nJeCmRwwvQmWg1jlXncN1aLbKiW37CXwI6J0M/obC4wfAprxPCaM9A696ohJe5mGLqBKlb97c4WTm1w5SjYuyHH4OPUVLJunKpHs5zHg6F9x6Pu2OEqSCma7OJlfy7s2n9vhpSfMNFn+HuzUkOerieF9XEkBFjW/0fSzJNVCRmXZo5dGTduG2qeeo38tAIDl8ZUXjsi1nye2sCugkvXxSXP4DlYljLK8oOwe2p+qkBxl/XlVOD3mH7/yYLCG1xeDm0hmb210ttiNUqqo3BQ30DfCBb9aJjJo6sd4f2ZM7L3ETF7ecXvSGUXPyLfd3MdKMmP0JDOasJ8pBlLSrA3JJ8eY/YzqyuDm2F4IQUSQ7QoX6C0z4ldxwHiAJltlqtFdwnoO1ivPYjxIBxnYnZB1BjNT0GP0c0p1QDgJPTPG+boq44Z8Sel1n0zdTTlJH1gfJQYsxHZyFKeK+mt4wydP+d2Umm3j8dW7jcFtFvYdBqPjHysUpqC1297T7A088C6CXfmwHHHDMmMS8CXQQrp7t4f6OEdIMAfrEad44GZjZwmU2nA0pr5GThFpFXPKnna27Nl79CH15qlPH9KJBpIh1QCNzaxbNi0g/O70XA7VxZP+9OWc0Dy1i0EKUUPvA== |


  Scenario Outline: Calculate message hash
    Given message <message>
    When I compute SHA256 hash of message content
    And encode resulting message hash with Base64  
    Then resulting message content hash <messageHash> should be <result>

  Examples:
  | message                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | result                                       |
  | QgO46Himh8a5fLBmZ1ypINLAI4Fb8V/e9r0ZhqQ6A8cOlilkYfh5yMr9eRgKNXBG4HDwSX4hw7kgIqXdEXPlxYXc0yvbW+v6kFTPMeT4J+8B3+fReQTEnGTIjnHK7X9PleNlyMBpajveDPN8NgR1/Ir11nJeCmRwwvQmWg1jlXncN1aLbKiW37CXwI6J0M/obC4wfAprxPCaM9A696ohJe5mGLqBKlb97c4WTm1w5SjYuyHH4OPUVLJunKpHs5zHg6F9x6Pu2OEqSCma7OJlfy7s2n9vhpSfMNFn+HuzUkOerieF9XEkBFjW/0fSzJNVCRmXZo5dGTduG2qeeo38tAIDl8ZUXjsi1nye2sCugkvXxSXP4DlYljLK8oOwe2p+qkBxl/XlVOD3mH7/yYLCG87u7D+t3CyeBdl3NR9ltizVZCehgf9SiVwsB9JD/gPIM7L3ETF7ecXvSGUXPyLfd3MdKMmP0JDOasJ8pBlLSrA3JJ8eY/YzqyuDm2F4IQUSQ7QoX6C0z4ldxwHiAJltlqtFdwnoO1ivPYjxIBxnYnZB1BjNT0GP0c0p1QDgJPTPG+boq44Z8Sel1n0zdTTlJH1gfJQYsxHZyFKeK+mt4wydP+d2Umm3j8dW7jcFtFvYdBqPjHysUpqC1297T7A088C6CXfmwHHHDMmMS8CXQQrp7t4f6OEdIMAfrEad44GZjZwmU2nA0pr5GThFpFXPKnna27Nl79CH15qlPH9KJBpIh1QCNzaxbNi0g/O70XA7VxZP+9OWc0Dy1i0EKUUPvA== | L7/ByXV9C4JsHD7VPsoW1csl+Vb0AjMti0/4T0mrTnY= |
  | QgO46Himh8a5fLBmZ1ypIDakRUSvEcFXLyG2NFEDlFQI61hW2EQucs3TeleiwKQY6p+ANdHFZ6doUmvWiXV/kRidryUT4lBIrteOiD5w3FoB3+fReQTEnGTIjnHK7X9PleNlyMBpajveDPN8NgR1/Ir11nJeCmRwwvQmWg1jlXncN1aLbKiW37CXwI6J0M/obC4wfAprxPCaM9A696ohJe5mGLqBKlb97c4WTm1w5SjYuyHH4OPUVLJunKpHs5zHg6F9x6Pu2OEqSCma7OJlfy7s2n9vhpSfMNFn+HuzUkOerieF9XEkBFjW/0fSzJNVCRmXZo5dGTduG2qeeo38tAIDl8ZUXjsi1nye2sCugkvXxSXP4DlYljLK8oOwe2p+qkBxl/XlVOD3mH7/yYLCG1nMgY0N7a7S1EHGrCJrrxyfavuU9IR79j8AK3mm6ruBM7L3ETF7ecXvSGUXPyLfd3MdKMmP0JDOasJ8pBlLSrA3JJ8eY/YzqyuDm2F4IQUSQ7QoX6C0z4ldxwHiAJltlqtFdwnoO1ivPYjxIBxnYnZB1BjNT0GP0c0p1QDgJPTPG+boq44Z8Sel1n0zdTTlJH1gfJQYsxHZyFKeK+mt4wydP+d2Umm3j8dW7jcFtFvYdBqPjHysUpqC1297T7A088C6CXfmwHHHDMmMS8CXQQrp7t4f6OEdIMAfrEad44GZjZwmU2nA0pr5GThFpFXPKnna27Nl79CH15qlPH9KJBpIh1QCNzaxbNi0g/O70XA7VxZP+9OWc0Dy1i0EKUUPvA== | zUvhDLqc08w9+vF4rmW56gxHApAI6dyzBpR49Q0NO6w= |
  | QgO46Himh8a5fLBmZ1ypIJLj+cMXKyyxXYb2n50dlNCvUPj2wJMjycLK/dGG3tFgYnqpa9zDgBySkMCKjiksoxHvBbDEau2usXXdcaPKGGUB3+fReQTEnGTIjnHK7X9PleNlyMBpajveDPN8NgR1/Ir11nJeCmRwwvQmWg1jlXncN1aLbKiW37CXwI6J0M/obC4wfAprxPCaM9A696ohJe5mGLqBKlb97c4WTm1w5SjYuyHH4OPUVLJunKpHs5zHg6F9x6Pu2OEqSCma7OJlfy7s2n9vhpSfMNFn+HuzUkOerieF9XEkBFjW/0fSzJNVCRmXZo5dGTduG2qeeo38tAIDl8ZUXjsi1nye2sCugkvXxSXP4DlYljLK8oOwe2p+qkBxl/XlVOD3mH7/yYLCG1xeDm0hmb210ttiNUqqo3BQ30DfCBb9aJjJo6sd4f2ZM7L3ETF7ecXvSGUXPyLfd3MdKMmP0JDOasJ8pBlLSrA3JJ8eY/YzqyuDm2F4IQUSQ7QoX6C0z4ldxwHiAJltlqtFdwnoO1ivPYjxIBxnYnZB1BjNT0GP0c0p1QDgJPTPG+boq44Z8Sel1n0zdTTlJH1gfJQYsxHZyFKeK+mt4wydP+d2Umm3j8dW7jcFtFvYdBqPjHysUpqC1297T7A088C6CXfmwHHHDMmMS8CXQQrp7t4f6OEdIMAfrEad44GZjZwmU2nA0pr5GThFpFXPKnna27Nl79CH15qlPH9KJBpIh1QCNzaxbNi0g/O70XA7VxZP+9OWc0Dy1i0EKUUPvA== | UWKHIY4TbQfg8Ftkue2C8f7/zIOPx4CpXKI4dQiwu6Y= |

  Scenario Outline: Calculate message body hash
    Given message body content <messageBody>
    When I compute SHA256 hash of message body
    And encode resulting message body hash with Base64  
    Then resulting message body hash <bodyHash> should be <result>

  Examples:
  | messageBody                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | result                                       |
  | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhPbmhzQjQ4S2tSQWd1TUpkNVJrbExRPT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx | 7KVD1TLkGsCVap3Lcm2i3kH8y06xkz2A6LlVwhURXFk= |
  | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhma3g1dlJ2QVliTS9KQkk4S3B6WFd3PT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx | ZyizIyWExijKo774EGVyIQVfEhggnTc+JaaXSHcZs0w= |
  | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhncTJVbmZQSFlKd09aWWthbmIxSFZBPT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx | q5RLDwUnwyUTmFr7ekU9JYNi6pOILUnVV+zEhI1MqiM= |

  Scenario Outline: Calculate dossier hash
    Given message body content <messageBody>
    And 40 bytes random salt <dossierSalt>
    When I compute HMAC-SHA256 hash of message body with given 40bytes salt
    And encode resulting message body hmac-hash with Base64  
    Then resulting <dossierHash> should be <result>

  Examples:
  | messageBody                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | dossierSalt                                                                                                             | result                                       |
  | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhPbmhzQjQ4S2tSQWd1TUpkNVJrbExRPT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx | 74:26:13:2f:4d:f3:f8:3e:82:ba:f3:fe:6a:dd:46:c2:00:4c:99:e8:88:ed:0f:a9:58:85:a2:11:9e:c8:b7:46:e4:f4:f0:c3:70:30:0e:17 | Num4y3dDxO2dpBvnbyo0JVk/WeXvzm3pSDvLL2F0h9w= |
  | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhma3g1dlJ2QVliTS9KQkk4S3B6WFd3PT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx | d3:11:19:a2:86:14:91:74:c7:d1:2c:10:04:59:a0:db:e5:75:e5:2c:1c:7e:9e:df:07:7c:90:8e:a0:aa:01:0b:ae:7f:b7:13:32:d3:d2:dc | lqVE9Uep/Izpyrnpf6TtKMMVzr69TeT1zbmPpVYiIrU= |
  | hq1ib290c3RyYXBBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5ckytYm9vdHN0cmFwTm9kZdoALmh0dHBzOi8vdGVsZWZlcmljLWRldi5keG1hcmtldHMuY29tL3RlbGVmZXJpYy+qaW52aXRlTmFtZbhncTJVbmZQSFlKd09aWWthbmIxSFZBPT2sb2ZmZXJpbmdBZGRy2gBKOE1TZDkxeHI2alNWNXBTMjlSa1Y3ZExlRTNoRGdMSEpHcnN5WHBkU2Y0aWl0ajZjNzV0VlNORVN5d0J6WXpGRWV5dTVEMXp5cky6c2VydmljZUFubm91bmNlbWVudE1lc3NhZ2XaACxMK1ZpUCtVRm5oYzZPYldmaHVncU5aZkUrU1prcW9TNDZJNFFidytOYk9ZPbFzZXJ2aWNlT2ZmZXJpbmdJRKEx | 80:9a:a9:b7:c4:d7:0c:4a:59:45:4e:b3:d5:7e:cc:b4:58:83:cf:e4:f5:5c:1e:68:2a:d1:0e:0d:45:c6:b4:cc:71:5d:b6:0d:62:45:25:26 | pXzoj0FiaWFZjwTcJtf9+ekgZNer2gJGOWUgKt1U8O0= |
  

  Scenario Outline: Generate Message signature
    Given following private key <privkey>
    """
    -----BEGIN RSA PRIVATE KEY-----
    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
    -----END RSA PRIVATE KEY-----
    """
    And message hash <messageHash>
    And teleferic signed timestamp <telefericSignedTimestamp>
    And compose signable object
    """
    {
      messageHash: <messageHash>,
      timestamp: <telefericSignedTimestamp>
    }
    """
    When I format signable object with Message Pack 
    And generate RSA signature <signature> using <privkey> of formated signable object
    And compose signature object
    """
    {
      signature: <signature>,
      timestamp: <telefericSignedTimestamp>
    }
    """
    And format signature object with Message Pack
    And encode resulted signature with Base64 
    Then resulting <messageSig> should be <result>


  Examples:
  | messageHash                                  | telefericSignedTimestamp                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
  | L7/ByXV9C4JsHD7VPsoW1csl+Vb0AjMti0/4T0mrTnY= | gqlzaWduYXR1cmXaAqx1WXdJa05IVWwwOVFocWZFWHlpMXQ0QkRDcDNLUzlWeXF0YVpIQjcrZm5KTGJMRXh3cjhFM1VjTWFzRFV1ZGJBK1JVcGQ4aEhGQkhBUC9aMEw3cVMzcWxzY3FzSlVvWUF3VXlUK0hIUklaeEhjbjBiRXFhK1dPYVVva2hNZEdlYWU1WUxnQnhTcWNiT0EwSGJjQ3ZVdHVBYm56QzJYRjg4S3dMdmNRRUx6UG16Q0tKUm0wME9BUGdXZmpPYjA5M25Sa0V2aXFZYWFlR2pjQmYzY1E5MUdpMVpjQytJdkJEamQ5MDcrUlBUOGt0enF4N1JoalpWVFFrQzZGU29wTk5NZ3NFeFN2T0FIWlYwR0Z0aVp1b0JrY2EraWo0MmZ0bkZXZ25aamMrd0NuK1BSanRuVVQrZkVnc2QvZExkWDNUQk9aeHBENTlWRkdSSjAyZU82YmRtaFFrK01wN0pZK2swdmtSbzRuVTVTMEM1dlZYRG85MllyNCsxWGNPZmFVbGhhR2pQZzBCdmRZSVVoRVBybmpiLzJ2MjFPWENQckQ1TGtsVWd4RmdINFJ5a1AzbktVMHBVWXUyMEtJOTRoY2JaSGM2ODhqNzBOOWZRdkpwSXJpWjJDWjdPR0VJaSs4M21iaWxSclJoR3I0MktnU2ZSOEV3c1VRa05RREVsS1dSVGdReFdxYjl1Z1dSekNLVjhlNUpWWHIxNW1lS0ZtZG8vcEdiakxCM0tKRXIvcDNrTXpWMlFKUmJhbXVpNytwa2lFQWk5bEZ2NVRMRDF0QUVZZVlqeVBZcEhPK2w0Q0p3em1lVWxpb2k1RkhaUld5aHJDTXpBNldDcnpFZWdiNnQwZjVVYjBqTW1FTG50WVNka0hlY0J6UWpLQ081aWcxL1huZjlBODA5NlBrYz2pdGltZXN0YW1wsjE1MTEzNTYxOTEuMTY2MjE3OA== | gqlzaWduYXR1cmXaAqxWblZVQ25LZklIeWM4cHk5TXFhZ2xtVkpwTUFRcU5YTlArSDh3M0dRZ1A4UTEzcFJZZnA2d1NGN1dYVlNHeDkrUkY1bUc4eGorZkdqQWxscFVGUHAzRldVSUJ0RjBZbUtRT1pvNzlENFI5dHFuSzlQeGExLzdvQ2RPeWlaMGVSYm9Kb1NxcjhhTVR0cmY0YjM4QUJlTUUwRHNzTnByNHFQRXdwMHRSeFZpSm9LS1lLUzJsZXdCTk1MbnNlMEZSM2RCUUloWW5DbkJmU0R0bGl6ajV4dmUxUzBpNTRtQUdxWHVaZW5lZmhZbmRsdzFvZ2dFY2N1d2Y1Qyt1cGx1TzZ5eDIrbkxqK3kyUDZmdHpmK2c1MFY4M2VPczdVMHlnUUVzS0l5U2ZLWk9JSTVrSkJ1MDd1Q0srS2pGUTczeUVoN29vaDFSTDRHQkVCNGNYZHVueEpBSmRuUXYrOEFtdlVFS0NFV3IweTR4VTNBcUV3ZHJPbHV6Y3FIUmVhSGVFQmFmcmxZRWJicldJSkJIMFVvcy9peU1WUisrZ0JjRDlRWVMySGZQVGR5LytoMkN1M21xVm5TK2RWSmMxVVZqZ0gvWDlBcU44OHBUN0NPT1NNOHIvbUtSYkZ2b2NPN3JTb1BnRjJ0QitlWDJqejVmTmd6MWVRSEN1OFNWOEZxOElac1BuN0QzejhwZkNDVUNRb1g5aDEwb24vTkdzV0J4NXI2RmNPbWFBV2h5Qm02RGN0eU8vSnpJWjJFS1lpeGhoZU93Y2RJQTRRNFdDa01qbnhOTHZjK0swemVXYVRmU0lVWnFTWU40bmkrS09WUTdISXdiZkFBQUNvL1lyRkVlR25LVnI4R3pib1BaL0FDQ2duMU1YTnNsTHhiSWNtckw2TEQzR09nRWdsUTJwOD2pdGltZXN0YW1w2gPMZ3FsemFXZHVZWFIxY21YYUFxeDFXWGRKYTA1SVZXd3dPVkZvY1daRldIbHBNWFEwUWtSRGNETkxVemxXZVhGMFlWcElRamNyWm01S1RHSk1SWGgzY2poRk0xVmpUV0Z6UkZWMVpHSkJLMUpWY0dRNGFFaEdRa2hCVUM5YU1FdzNjVk16Y1d4elkzRnpTbFZ2V1VGM1ZYbFVLMGhJVWtsYWVFaGpiakJpUlhGaEsxZFBZVlZ2YTJoTlpFZGxZV1UxV1V4blFuaFRjV05pVDBFd1NHSmpRM1pWZEhWQlltNTZRekpZUmpnNFMzZE1kbU5SUlV4NlVHMTZRMHRLVW0wd01FOUJVR2RYWm1wUFlqQTVNMjVTYTBWMmFYRlpZV0ZsUjJwalFtWXpZMUU1TVVkcE1WcGpReXRKZGtKRWFtUTVNRGNyVWxCVU9HdDBlbkY0TjFKb2FscFdWRkZyUXpaR1UyOXdUazVOWjNORmVGTjJUMEZJV2xZd1IwWjBhVnAxYjBKclkyRXJhV28wTW1aMGJrWlhaMjVhYW1NcmQwTnVLMUJTYW5SdVZWUXJaa1ZuYzJRdlpFeGtXRE5VUWs5YWVIQkVOVGxXUmtkU1NqQXlaVTgyWW1SdGFGRnJLMDF3TjBwWksyc3dkbXRTYnpSdVZUVlRNRU0xZGxaWVJHODVNbGx5TkNzeFdHTlBabUZWYkdoaFIycFFaekJDZG1SWlNWVm9SVkJ5Ym1waUx6SjJNakZQV0VOUWNrUTFUR3RzVldkNFJtZElORko1YTFBemJrdFZNSEJWV1hVeU1FdEpPVFJvWTJKYVNHTTJPRGhxTnpCT09XWlJka3B3U1hKcFdqSkRXamRQUjBWSmFTczRNMjFpYVd4U2NsSm9SM0kwTWt0blUyWlNPRVYzYzFWUmEwNVJSRVZzUzFkU1ZHZFJlRmR4WWpsMVoxZFNla05MVmpobE5VcFdXSEl4TlcxbFMwWnRaRzh2Y0VkaWFreENNMHRLUlhJdmNETnJUWHBXTWxGS1VtSmhiWFZwTnl0d2EybEZRV2s1YkVaMk5WUk1SREYwUVVWWlpWbHFlVkJaY0VoUEsydzBRMHAzZW0xbFZXeHBiMmsxUmtoYVVsZDVhSEpEVFhwQk5sZERjbnBGWldkaU5uUXdaalZWWWpCcVRXMUZURzUwV1ZOa2EwaGxZMEo2VVdwTFEwODFhV2N4TDFodVpqbEJPREE1TmxCcll6MnBkR2x0WlhOMFlXMXdzakUxTVRFek5UWXhPVEV1TVRZMk1qRTNPQT09 |
  | zUvhDLqc08w9+vF4rmW56gxHApAI6dyzBpR49Q0NO6w= | gqlzaWduYXR1cmXaAqxFK2tsMXprM1VPU3Fra1A1am12bXgvQkF4S2wxVm15QWo2Q0xFMkxmZDlDQ2NOWGdvOUxIc1pGRlNHTkNBTWJtMDhXV256SVZBK0xHQy9SMlJ6ck1WNUYvaHVsbE1zcGh0VE5xa0ltUVJGTG1yN0tIMDNwUFNnblpDdk9rdTlRUjlsZXRpdlhDVzduVG1HYklIUHZmaFNLZlFYNWo1bFNna3FVNWNqSGdZTnU5VzliazJtbE1QTTAzS0Y3S1pJbkw3VnJSSklxWmNPcmJCbFpiK1lvL3IxNkUxRWRkd2RyRWE2TTlnRDhzZXVubC8vQitycXk0YlQ1MkVhSnBJN3NGb25RVTgxbWxteXZNbENVSTA3cjJPbzcwVHBGRU9JNFkrTzNWVXNET3dTUlNEeEJjTkMzc1UvRUMwOVY2NDFNS1diZUtjc29VaG85VEFrcDZtVU54S0QyY3RPcCsyR0tuenphOEFwbVl3Qm9hUTM2TlRYYWpjdVlRZlNiWm93NjlSdG9raE9oSVVkSDFoUXRGYjhtVnQ5dFp5clJsL2MvTElmOTdkRHdiZWRiZkFmNE40QUxuSkdvYnpHZkp2WFR6cVJyUGIzWHEyeEtTSkxtQTVpY25lUU5EeVIyc0JlakpZcUNUM2lTaWRoZzdXaTRvV1BpNGtFNTNVdjA3TC9JazloTFdPYmd1NWZtM2ljcU9SWFhXREJtWERUelVHYXRadEgxMCtPTm44V0thQ0doR1Q1Q2ZZWWRLUkd4bHpnTllxblI3TkJVNVpEUXNDemVIWGpmRE9raEw3b2dOTVAva2JXNXF5SXUwYUJuTjMwRGxaUFpnUFVJcnRFOFh2cWRYb3NJdVcza24zOER3dmhsa1owQ1cxdGJsVXZYVUx5R1lBbzh4K2ZMWW5uST2pdGltZXN0YW1wsjE1MTEzNTYyNzEuMTYyOTY0Ng== | gqlzaWduYXR1cmXaAqxVUlZKZzU0S01zTWhOQkZFU1FtNHJrME9CRS9KM1ZhR0VxcUU2TW9oNVRWaW0xV21BSlJTYUwyQlVDb0lnTmVUN2lLbFpObHk4ckJlR01EdDFGN3J5REhYc1NNTDJ6cHRPVTJIcXJxZTNITHE2bFFRUTE3M3pzT2J1U3g0K1NxdlA3NlpsNlRnencyaExIWG92NmloK0QvMEJpL0tnL1FQOHExQmdHN0FTdlNaVTZMeXM3bTNsdWJ0bms1YTlZNTAvckIzUlhZT1VCRmtDOTZpcklHc0E2cmd0VmZQQStrT1NIek4rYWEvUTZTald0U01XbTJXazZDQ1dRZ0VLNzcvakFRTTBteE9oRjk1bmUwR29DUHJQRi81RmVlRkhzTFRiUkpjaWw0V1BqY3VXbStTbitsSmsxZ0p0QTY5NHhBdW9ra1lLWDZZczZXMkVXWmNKRHZybCtvbDBHbVJDNnJrYVFiQmpFY1c0MjlDOVpjZjN1ZlFaRHNYWTJRTU53OEdWbHIwT1FTY1M2SHpuSnJyMC85YTdGdVJhZ3RId01IVEhPbVZSTUVtMDBhb2FDcUNxY0FQU1ZQYmdOS0lTOWNpT3R3UXRHQ0FVd2JUcjVIZ2JTbjR6UHRZQnJ5ZmpCaG1KNHpPVzNmdDhLRC8xRHlhaVdOMytPZ1dQWFFTbWxFMTFDTDBYRHJGNGVZS3U2azR4QzhkaHVja0R6ZWpZOWxCV0NMVWZLSUZvRTdVTGVHUDV6WkViRUhwMFpYRU1UcnRhaDNsd210aThCeXJpR1Z0ZUg2M2VocDROM3ZtdjVNMGVwWUltSlBnbFdUUmpXdW53VzhUZkd5V3F3cER2R0c3N05UQzBHSTFFQmVhTUpWc01FMnptQm1UQzRWQ01wOU1BSGI0MTVVaDNIOD2pdGltZXN0YW1w2gPMZ3FsemFXZHVZWFIxY21YYUFxeEZLMnRzTVhwck0xVlBVM0ZyYTFBMWFtMTJiWGd2UWtGNFMyd3hWbTE1UVdvMlEweEZNa3htWkRsRFEyTk9XR2R2T1V4SWMxcEdSbE5IVGtOQlRXSnRNRGhYVjI1NlNWWkJLMHhIUXk5U01sSjZjazFXTlVZdmFIVnNiRTF6Y0doMFZFNXhhMGx0VVZKR1RHMXlOMHRJTUROd1VGTm5ibHBEZGs5cmRUbFJVamxzWlhScGRsaERWemR1VkcxSFlrbElVSFptYUZOTFpsRllOV28xYkZObmEzRlZOV05xU0dkWlRuVTVWemxpYXpKdGJFMVFUVEF6UzBZM1MxcEpia3czVm5KU1NrbHhXbU5QY21KQ2JGcGlLMWx2TDNJeE5rVXhSV1JrZDJSeVJXRTJUVGxuUkRoelpYVnViQzh2UWl0eWNYazBZbFExTWtWaFNuQkpOM05HYjI1UlZUZ3hiV3h0ZVhaTmJFTlZTVEEzY2pKUGJ6Y3dWSEJHUlU5Sk5Ga3JUek5XVlhORVQzZFRVbE5FZUVKalRrTXpjMVV2UlVNd09WWTJOREZOUzFkaVpVdGpjMjlWYUc4NVZFRnJjRFp0VlU1NFMwUXlZM1JQY0NzeVIwdHVlbnBoT0VGd2JWbDNRbTloVVRNMlRsUllZV3BqZFZsUlpsTmlXbTkzTmpsU2RHOXJhRTlvU1ZWa1NERm9VWFJHWWpodFZuUTVkRnA1Y2xKc0wyTXZURWxtT1Rka1JIZGlaV1JpWmtGbU5FNDBRVXh1U2tkdllucEhaa3AyV0ZSNmNWSnlVR0l6V0hFeWVFdFRTa3h0UVRWcFkyNWxVVTVFZVZJeWMwSmxha3BaY1VOVU0ybFRhV1JvWnpkWGFUUnZWMUJwTkd0Rk5UTlZkakEzVEM5SmF6bG9URmRQWW1kMU5XWnRNMmxqY1U5U1dGaFhSRUp0V0VSVWVsVkhZWFJhZEVneE1DdFBUbTQ0VjB0aFEwZG9SMVExUTJaWldXUkxVa2Q0YkhwblRsbHhibEkzVGtKVk5WcEVVWE5EZW1WSVdHcG1SRTlyYUV3M2IyZE9UVkF2YTJKWE5YRjVTWFV3WVVKdVRqTXdSR3hhVUZwblVGVkpjblJGT0ZoMmNXUlliM05KZFZjemEyNHpPRVIzZG1oc2Exb3dRMWN4ZEdKc1ZYWllWVXg1UjFsQmJ6aDRLMlpNV1c1dVNUMnBkR2x0WlhOMFlXMXdzakUxTVRFek5UWXlOekV1TVRZeU9UWTBOZz09 |
  | UWKHIY4TbQfg8Ftkue2C8f7/zIOPx4CpXKI4dQiwu6Y= | gqlzaWduYXR1cmXaAqxISlpXNEg2QlZGMzlRWlozUXE0blJnZTI1MkpXUUx3RVhyb25TUmIwSFFoYXRlT0dQY1VHTlRGbmdOL0RMN1pwODA4NzJTL0ZpNFZheHlqTDdiaWkxR1c1dThFYi91RnE4UVZ0SWRsZ1J6ZXVLeU1IdWNCSFkwQmM3UGNsNFB5eDR4a2xIRllLTDVncnVpU2RkemNkdWNRbEVTYys5NHlDRm1XaU5LNG8xalF2ZFREZEVwNjdKekwwNnVmWWxFbWlOQVhhT0dETEZtTStZaXJZUnRhSDlzVVkrdG53aDJqWExMN3VNUTVQS2gyclYzbkxhR3JZdFEvNFJhUnloVEhxNnZ5R2xDVXltSzRIcENTZjRzT0tXY1BXQlp0U1hMc3ZLM0dMbnl1Q0YrWWJnMC9zZ0lGOVU3N1hWTTYvUDgxOTNCWUp0UlZMLzRnNjg1Y0FsbkFRL01HOTFvUVQxVk5jRHpBdm1JNEJLVERqc3BXZkZET1RwelNEdVM0SGN1SjFVdUdCWVBMYm5IeHBDdW9sYjA4bkIzd1crc3pVUkdhbC9HOENON1FPcGxPOE0wWFBMZGhIUTgvM29iZWtRZm1JekwvTXhQZVpwb05wL0lFdEJVVTA4M2NyV1owaXJ3ZHVTdkJhVWxWaTBhTGxrYmpPc2k0bFhRTzlweUh4RlBobm1VTkVwcHM5QVVCUnl6bmtXYkhFQStOMTZRVG5yTkY5ZjBmQVdNcFh6T202bHE4cnJER3h4OFphOUxOU3oyN0NaVEw5L1VOSTdjZStmOFU4NzZtUmhJN0k2RkpOclBGbkhzdG9zNWpVZkxEMVE3M2xXVHl1Yjk3OUM4WmNlNTJpeUFmS3QxbEVOMHllQlBzRFNydXNuTFdDNGhMU3YzRFo2T2s1VW83S3Y5az2pdGltZXN0YW1wsjE1MTEzNTYyODMuMjI3MDcwOA== | gqlzaWduYXR1cmXaAqxmeWxIbHVEeDNESFZlWUN0RTBGd09OZEJiZkZqbmpmWVV5RnJHN0NmM1VUZTJ2Vjc1N3BGNEc5bDJQczBBd3B0WHg2UzQ4RjZvSDFzQzNscXQveGMzam9HZkVhNTkxMXROa3RWbk0zQmpueFZxUGVvbmVHc3M2dVB3RThXbTgvcm8wK2tMTktOcFVvTDFTSWVyQk55Y1BrRUFkNGc1MmJscmxLS0NIT2w1UnhUWFU2Y1JmQnhZMUtPMnhjWEtjTkFkamU5SmVEVDlUT3c3T292N2pVR1NPUm9naXJ4R29HQlBCMEFKZHdLaGZUUEhNbmFSUDJNOUhIdlBtRzE4Z0QxN2VjT0xUMjRlb3JQV2FpdXRHTFc1Y2xjWmlvSnd1L2MzM0ZibGt6TlVhdjR2NXZpU1dWSFpuTDk5V0draGc2OUFFTVZsOXBTNHRQYVhvS3FLQW56SE0xVUswZGdmVm9HQUdpL21zZyt0Y0tCR2JuUFZCTTNYZ2JRMHd6azV3UVdEMUlNczQrZ2JsUEhCb3lwNis5cnFOQ081clJ5WlBMRjcwU3dBY3RxMDMzSW9ndWE5RnFodlBEb1lGNlZUWjNGMkdxNjJZZDNLZjBPR0Z6WlBpdzVEcTk1TUc4eDBSVDh6bnNMRWllT0VzRzVHemlISGZON0FLcTRBN3lqd21TM2JBU3poSjBpcWxib3BaaVRieWNsLzJnQVpuRUpRV1hnM3QyM20vSmhLSmNqNUVEd3VQNEdzQnRQeUxnSkR4a1J3WURZUUh6ZjFjLzc2NWtIUmEzZTE0elFPaUdQZHowK0tobHpRNzRoYW1kb1h3VnJzYW5SYXduT3dtM1Y2VmVjY0dSOTBmVnM4TGY2VnVLRVJBRHdNSzdtNForUzEySUptazFKQ1cvTC9jMD2pdGltZXN0YW1w2gPMZ3FsemFXZHVZWFIxY21YYUFxeElTbHBYTkVnMlFsWkdNemxSV2xvelVYRTBibEpuWlRJMU1rcFhVVXgzUlZoeWIyNVRVbUl3U0ZGb1lYUmxUMGRRWTFWSFRsUkdibWRPTDBSTU4xcHdPREE0TnpKVEwwWnBORlpoZUhscVREZGlhV2t4UjFjMWRUaEZZaTkxUm5FNFVWWjBTV1JzWjFKNlpYVkxlVTFJZFdOQ1NGa3dRbU0zVUdOc05GQjVlRFI0YTJ4SVJsbExURFZuY25WcFUyUmtlbU5rZFdOUmJFVlRZeXM1TkhsRFJtMVhhVTVMTkc4eGFsRjJaRlJFWkVWd05qZEtla3d3Tm5WbVdXeEZiV2xPUVZoaFQwZEVURVp0VFN0WmFYSlpVblJoU0RselZWa3JkRzUzYURKcVdFeE1OM1ZOVVRWUVMyZ3ljbFl6Ymt4aFIzSlpkRkV2TkZKaFVubG9WRWh4Tm5aNVIyeERWWGx0U3pSSWNFTlRaalJ6VDB0WFkxQlhRbHAwVTFoTWMzWkxNMGRNYm5sMVEwWXJXV0puTUM5elowbEdPVlUzTjFoV1RUWXZVRGd4T1ROQ1dVcDBVbFpNTHpSbk5qZzFZMEZzYmtGUkwwMUhPVEZ2VVZReFZrNWpSSHBCZG0xSk5FSkxWRVJxYzNCWFprWkVUMVJ3ZWxORWRWTTBTR04xU2pGVmRVZENXVkJNWW01SWVIQkRkVzlzWWpBNGJrSXpkMWNyYzNwVlVrZGhiQzlIT0VOT04xRlBjR3hQT0Uwd1dGQk1aR2hJVVRndk0yOWlaV3RSWm0xSmVrd3ZUWGhRWlZwd2IwNXdMMGxGZEVKVlZUQTRNMk55VjFvd2FYSjNaSFZUZGtKaFZXeFdhVEJoVEd4clltcFBjMmswYkZoUlR6bHdlVWg0UmxCb2JtMVZUa1Z3Y0hNNVFWVkNVbmw2Ym10WFlraEZRU3RPTVRaUlZHNXlUa1k1WmpCbVFWZE5jRmg2VDIwMmJIRTRjbkpFUjNoNE9GcGhPVXhPVTNveU4wTmFWRXc1TDFWT1NUZGpaU3RtT0ZVNE56WnRVbWhKTjBrMlJrcE9jbEJHYmtoemRHOXpOV3BWWmt4RU1WRTNNMnhYVkhsMVlqazNPVU00V21ObE5USnBlVUZtUzNReGJFVk9NSGxsUWxCelJGTnlkWE51VEZkRE5HaE1VM1l6UkZvMlQyczFWVzgzUzNZNWF6MnBkR2x0WlhOMFlXMXdzakUxTVRFek5UWXlPRE11TWpJM01EY3dPQT09 |
  

  Scenario Outline: Send Message
    Given bootstrap node url https://teleferic-dev.dxmarkets.com/teleferic/
    And sender address <sender>
    And message type <messageType>
    And message hash <messageHash>
    And body hash <bodyHash>
    And message signature <messageSig>
    And message <message>
    And dossier hash <dossierHash>
    And following mutation
    """
    mutation (
      $sender: Address!
      $messageType: MessageType!
      $messageHash: SHA256!
      $bodyHash: SHA256!
      $messageSig: Sign!
      $message: AESEncryptedBlob!
      $dossierHash: HMACSHA256!
    ){
      sendMessage(
        envelope: {
          sender: $sender
          messageType: $messageType
          messageHash: $messageHash
          bodyHash: $bodyHash
          messageSig: $messageSig
          message: $message
          dossierHash: $dossierHash
        }
      ) {
        messageHash
      }
    }
    """
    When I compose variable object
    """
    {
      "sender": "<sender>",
      "messageType": "<messageType>",
      "messageHash": "<messageHash>",
      "bodyHash": "<bodyHash>",
      "messageSig": "<messageSig>",
      "message": "<message>",
      "dossierHash": "<dossierHash>"
    }
    """
    And send mutation with variables to bootstrap node <bootstrapNode>
    Then response should be success
    And response should have messageHash property equal to <messageHash>

    Examples:
    | sender                                                              | messageType  | messageHash                                  | bodyHash                                     | dossierHash                                  | messageSig                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | message                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
    | iZn2hyWChp6hkHEobZNdE9vmruR3MNVQZVFoBMc6PHEvKmaQM1jKoEC1uDF5Qf7deXN | REGISTRATION | L7/ByXV9C4JsHD7VPsoW1csl+Vb0AjMti0/4T0mrTnY= | 7KVD1TLkGsCVap3Lcm2i3kH8y06xkz2A6LlVwhURXFk= | Num4y3dDxO2dpBvnbyo0JVk/WeXvzm3pSDvLL2F0h9w= | gqlzaWduYXR1cmXaAqxWblZVQ25LZklIeWM4cHk5TXFhZ2xtVkpwTUFRcU5YTlArSDh3M0dRZ1A4UTEzcFJZZnA2d1NGN1dYVlNHeDkrUkY1bUc4eGorZkdqQWxscFVGUHAzRldVSUJ0RjBZbUtRT1pvNzlENFI5dHFuSzlQeGExLzdvQ2RPeWlaMGVSYm9Kb1NxcjhhTVR0cmY0YjM4QUJlTUUwRHNzTnByNHFQRXdwMHRSeFZpSm9LS1lLUzJsZXdCTk1MbnNlMEZSM2RCUUloWW5DbkJmU0R0bGl6ajV4dmUxUzBpNTRtQUdxWHVaZW5lZmhZbmRsdzFvZ2dFY2N1d2Y1Qyt1cGx1TzZ5eDIrbkxqK3kyUDZmdHpmK2c1MFY4M2VPczdVMHlnUUVzS0l5U2ZLWk9JSTVrSkJ1MDd1Q0srS2pGUTczeUVoN29vaDFSTDRHQkVCNGNYZHVueEpBSmRuUXYrOEFtdlVFS0NFV3IweTR4VTNBcUV3ZHJPbHV6Y3FIUmVhSGVFQmFmcmxZRWJicldJSkJIMFVvcy9peU1WUisrZ0JjRDlRWVMySGZQVGR5LytoMkN1M21xVm5TK2RWSmMxVVZqZ0gvWDlBcU44OHBUN0NPT1NNOHIvbUtSYkZ2b2NPN3JTb1BnRjJ0QitlWDJqejVmTmd6MWVRSEN1OFNWOEZxOElac1BuN0QzejhwZkNDVUNRb1g5aDEwb24vTkdzV0J4NXI2RmNPbWFBV2h5Qm02RGN0eU8vSnpJWjJFS1lpeGhoZU93Y2RJQTRRNFdDa01qbnhOTHZjK0swemVXYVRmU0lVWnFTWU40bmkrS09WUTdISXdiZkFBQUNvL1lyRkVlR25LVnI4R3pib1BaL0FDQ2duMU1YTnNsTHhiSWNtckw2TEQzR09nRWdsUTJwOD2pdGltZXN0YW1w2gPMZ3FsemFXZHVZWFIxY21YYUFxeDFXWGRKYTA1SVZXd3dPVkZvY1daRldIbHBNWFEwUWtSRGNETkxVemxXZVhGMFlWcElRamNyWm01S1RHSk1SWGgzY2poRk0xVmpUV0Z6UkZWMVpHSkJLMUpWY0dRNGFFaEdRa2hCVUM5YU1FdzNjVk16Y1d4elkzRnpTbFZ2V1VGM1ZYbFVLMGhJVWtsYWVFaGpiakJpUlhGaEsxZFBZVlZ2YTJoTlpFZGxZV1UxV1V4blFuaFRjV05pVDBFd1NHSmpRM1pWZEhWQlltNTZRekpZUmpnNFMzZE1kbU5SUlV4NlVHMTZRMHRLVW0wd01FOUJVR2RYWm1wUFlqQTVNMjVTYTBWMmFYRlpZV0ZsUjJwalFtWXpZMUU1TVVkcE1WcGpReXRKZGtKRWFtUTVNRGNyVWxCVU9HdDBlbkY0TjFKb2FscFdWRkZyUXpaR1UyOXdUazVOWjNORmVGTjJUMEZJV2xZd1IwWjBhVnAxYjBKclkyRXJhV28wTW1aMGJrWlhaMjVhYW1NcmQwTnVLMUJTYW5SdVZWUXJaa1ZuYzJRdlpFeGtXRE5VUWs5YWVIQkVOVGxXUmtkU1NqQXlaVTgyWW1SdGFGRnJLMDF3TjBwWksyc3dkbXRTYnpSdVZUVlRNRU0xZGxaWVJHODVNbGx5TkNzeFdHTlBabUZWYkdoaFIycFFaekJDZG1SWlNWVm9SVkJ5Ym1waUx6SjJNakZQV0VOUWNrUTFUR3RzVldkNFJtZElORko1YTFBemJrdFZNSEJWV1hVeU1FdEpPVFJvWTJKYVNHTTJPRGhxTnpCT09XWlJka3B3U1hKcFdqSkRXamRQUjBWSmFTczRNMjFpYVd4U2NsSm9SM0kwTWt0blUyWlNPRVYzYzFWUmEwNVJSRVZzUzFkU1ZHZFJlRmR4WWpsMVoxZFNla05MVmpobE5VcFdXSEl4TlcxbFMwWnRaRzh2Y0VkaWFreENNMHRLUlhJdmNETnJUWHBXTWxGS1VtSmhiWFZwTnl0d2EybEZRV2s1YkVaMk5WUk1SREYwUVVWWlpWbHFlVkJaY0VoUEsydzBRMHAzZW0xbFZXeHBiMmsxUmtoYVVsZDVhSEpEVFhwQk5sZERjbnBGWldkaU5uUXdaalZWWWpCcVRXMUZURzUwV1ZOa2EwaGxZMEo2VVdwTFEwODFhV2N4TDFodVpqbEJPREE1TmxCcll6MnBkR2x0WlhOMFlXMXdzakUxTVRFek5UWXhPVEV1TVRZMk1qRTNPQT09 | QgO46Himh8a5fLBmZ1ypINLAI4Fb8V/e9r0ZhqQ6A8cOlilkYfh5yMr9eRgKNXBG4HDwSX4hw7kgIqXdEXPlxYXc0yvbW+v6kFTPMeT4J+8B3+fReQTEnGTIjnHK7X9PleNlyMBpajveDPN8NgR1/Ir11nJeCmRwwvQmWg1jlXncN1aLbKiW37CXwI6J0M/obC4wfAprxPCaM9A696ohJe5mGLqBKlb97c4WTm1w5SjYuyHH4OPUVLJunKpHs5zHg6F9x6Pu2OEqSCma7OJlfy7s2n9vhpSfMNFn+HuzUkOerieF9XEkBFjW/0fSzJNVCRmXZo5dGTduG2qeeo38tAIDl8ZUXjsi1nye2sCugkvXxSXP4DlYljLK8oOwe2p+qkBxl/XlVOD3mH7/yYLCG87u7D+t3CyeBdl3NR9ltizVZCehgf9SiVwsB9JD/gPIM7L3ETF7ecXvSGUXPyLfd3MdKMmP0JDOasJ8pBlLSrA3JJ8eY/YzqyuDm2F4IQUSQ7QoX6C0z4ldxwHiAJltlqtFdwnoO1ivPYjxIBxnYnZB1BjNT0GP0c0p1QDgJPTPG+boq44Z8Sel1n0zdTTlJH1gfJQYsxHZyFKeK+mt4wydP+d2Umm3j8dW7jcFtFvYdBqPjHysUpqC1297T7A088C6CXfmwHHHDMmMS8CXQQrp7t4f6OEdIMAfrEad44GZjZwmU2nA0pr5GThFpFXPKnna27Nl79CH15qlPH9KJBpIh1QCNzaxbNi0g/O70XA7VxZP+9OWc0Dy1i0EKUUPvA== | 
    | iZn2hyWChp6hkHEobZNdE9vmruR3MNVQZVFoBMc6PHEvKmaQM1jKoEC1uDF5Qf7deXN | REGISTRATION | zUvhDLqc08w9+vF4rmW56gxHApAI6dyzBpR49Q0NO6w= | ZyizIyWExijKo774EGVyIQVfEhggnTc+JaaXSHcZs0w= | lqVE9Uep/Izpyrnpf6TtKMMVzr69TeT1zbmPpVYiIrU= | gqlzaWduYXR1cmXaAqxVUlZKZzU0S01zTWhOQkZFU1FtNHJrME9CRS9KM1ZhR0VxcUU2TW9oNVRWaW0xV21BSlJTYUwyQlVDb0lnTmVUN2lLbFpObHk4ckJlR01EdDFGN3J5REhYc1NNTDJ6cHRPVTJIcXJxZTNITHE2bFFRUTE3M3pzT2J1U3g0K1NxdlA3NlpsNlRnencyaExIWG92NmloK0QvMEJpL0tnL1FQOHExQmdHN0FTdlNaVTZMeXM3bTNsdWJ0bms1YTlZNTAvckIzUlhZT1VCRmtDOTZpcklHc0E2cmd0VmZQQStrT1NIek4rYWEvUTZTald0U01XbTJXazZDQ1dRZ0VLNzcvakFRTTBteE9oRjk1bmUwR29DUHJQRi81RmVlRkhzTFRiUkpjaWw0V1BqY3VXbStTbitsSmsxZ0p0QTY5NHhBdW9ra1lLWDZZczZXMkVXWmNKRHZybCtvbDBHbVJDNnJrYVFiQmpFY1c0MjlDOVpjZjN1ZlFaRHNYWTJRTU53OEdWbHIwT1FTY1M2SHpuSnJyMC85YTdGdVJhZ3RId01IVEhPbVZSTUVtMDBhb2FDcUNxY0FQU1ZQYmdOS0lTOWNpT3R3UXRHQ0FVd2JUcjVIZ2JTbjR6UHRZQnJ5ZmpCaG1KNHpPVzNmdDhLRC8xRHlhaVdOMytPZ1dQWFFTbWxFMTFDTDBYRHJGNGVZS3U2azR4QzhkaHVja0R6ZWpZOWxCV0NMVWZLSUZvRTdVTGVHUDV6WkViRUhwMFpYRU1UcnRhaDNsd210aThCeXJpR1Z0ZUg2M2VocDROM3ZtdjVNMGVwWUltSlBnbFdUUmpXdW53VzhUZkd5V3F3cER2R0c3N05UQzBHSTFFQmVhTUpWc01FMnptQm1UQzRWQ01wOU1BSGI0MTVVaDNIOD2pdGltZXN0YW1w2gPMZ3FsemFXZHVZWFIxY21YYUFxeEZLMnRzTVhwck0xVlBVM0ZyYTFBMWFtMTJiWGd2UWtGNFMyd3hWbTE1UVdvMlEweEZNa3htWkRsRFEyTk9XR2R2T1V4SWMxcEdSbE5IVGtOQlRXSnRNRGhYVjI1NlNWWkJLMHhIUXk5U01sSjZjazFXTlVZdmFIVnNiRTF6Y0doMFZFNXhhMGx0VVZKR1RHMXlOMHRJTUROd1VGTm5ibHBEZGs5cmRUbFJVamxzWlhScGRsaERWemR1VkcxSFlrbElVSFptYUZOTFpsRllOV28xYkZObmEzRlZOV05xU0dkWlRuVTVWemxpYXpKdGJFMVFUVEF6UzBZM1MxcEpia3czVm5KU1NrbHhXbU5QY21KQ2JGcGlLMWx2TDNJeE5rVXhSV1JrZDJSeVJXRTJUVGxuUkRoelpYVnViQzh2UWl0eWNYazBZbFExTWtWaFNuQkpOM05HYjI1UlZUZ3hiV3h0ZVhaTmJFTlZTVEEzY2pKUGJ6Y3dWSEJHUlU5Sk5Ga3JUek5XVlhORVQzZFRVbE5FZUVKalRrTXpjMVV2UlVNd09WWTJOREZOUzFkaVpVdGpjMjlWYUc4NVZFRnJjRFp0VlU1NFMwUXlZM1JQY0NzeVIwdHVlbnBoT0VGd2JWbDNRbTloVVRNMlRsUllZV3BqZFZsUlpsTmlXbTkzTmpsU2RHOXJhRTlvU1ZWa1NERm9VWFJHWWpodFZuUTVkRnA1Y2xKc0wyTXZURWxtT1Rka1JIZGlaV1JpWmtGbU5FNDBRVXh1U2tkdllucEhaa3AyV0ZSNmNWSnlVR0l6V0hFeWVFdFRTa3h0UVRWcFkyNWxVVTVFZVZJeWMwSmxha3BaY1VOVU0ybFRhV1JvWnpkWGFUUnZWMUJwTkd0Rk5UTlZkakEzVEM5SmF6bG9URmRQWW1kMU5XWnRNMmxqY1U5U1dGaFhSRUp0V0VSVWVsVkhZWFJhZEVneE1DdFBUbTQ0VjB0aFEwZG9SMVExUTJaWldXUkxVa2Q0YkhwblRsbHhibEkzVGtKVk5WcEVVWE5EZW1WSVdHcG1SRTlyYUV3M2IyZE9UVkF2YTJKWE5YRjVTWFV3WVVKdVRqTXdSR3hhVUZwblVGVkpjblJGT0ZoMmNXUlliM05KZFZjemEyNHpPRVIzZG1oc2Exb3dRMWN4ZEdKc1ZYWllWVXg1UjFsQmJ6aDRLMlpNV1c1dVNUMnBkR2x0WlhOMFlXMXdzakUxTVRFek5UWXlOekV1TVRZeU9UWTBOZz09 | QgO46Himh8a5fLBmZ1ypIDakRUSvEcFXLyG2NFEDlFQI61hW2EQucs3TeleiwKQY6p+ANdHFZ6doUmvWiXV/kRidryUT4lBIrteOiD5w3FoB3+fReQTEnGTIjnHK7X9PleNlyMBpajveDPN8NgR1/Ir11nJeCmRwwvQmWg1jlXncN1aLbKiW37CXwI6J0M/obC4wfAprxPCaM9A696ohJe5mGLqBKlb97c4WTm1w5SjYuyHH4OPUVLJunKpHs5zHg6F9x6Pu2OEqSCma7OJlfy7s2n9vhpSfMNFn+HuzUkOerieF9XEkBFjW/0fSzJNVCRmXZo5dGTduG2qeeo38tAIDl8ZUXjsi1nye2sCugkvXxSXP4DlYljLK8oOwe2p+qkBxl/XlVOD3mH7/yYLCG1nMgY0N7a7S1EHGrCJrrxyfavuU9IR79j8AK3mm6ruBM7L3ETF7ecXvSGUXPyLfd3MdKMmP0JDOasJ8pBlLSrA3JJ8eY/YzqyuDm2F4IQUSQ7QoX6C0z4ldxwHiAJltlqtFdwnoO1ivPYjxIBxnYnZB1BjNT0GP0c0p1QDgJPTPG+boq44Z8Sel1n0zdTTlJH1gfJQYsxHZyFKeK+mt4wydP+d2Umm3j8dW7jcFtFvYdBqPjHysUpqC1297T7A088C6CXfmwHHHDMmMS8CXQQrp7t4f6OEdIMAfrEad44GZjZwmU2nA0pr5GThFpFXPKnna27Nl79CH15qlPH9KJBpIh1QCNzaxbNi0g/O70XA7VxZP+9OWc0Dy1i0EKUUPvA== |
    | iZn2hyWChp6hkHEobZNdE9vmruR3MNVQZVFoBMc6PHEvKmaQM1jKoEC1uDF5Qf7deXN | REGISTRATION | UWKHIY4TbQfg8Ftkue2C8f7/zIOPx4CpXKI4dQiwu6Y= | q5RLDwUnwyUTmFr7ekU9JYNi6pOILUnVV+zEhI1MqiM= | pXzoj0FiaWFZjwTcJtf9+ekgZNer2gJGOWUgKt1U8O0= | gqlzaWduYXR1cmXaAqxmeWxIbHVEeDNESFZlWUN0RTBGd09OZEJiZkZqbmpmWVV5RnJHN0NmM1VUZTJ2Vjc1N3BGNEc5bDJQczBBd3B0WHg2UzQ4RjZvSDFzQzNscXQveGMzam9HZkVhNTkxMXROa3RWbk0zQmpueFZxUGVvbmVHc3M2dVB3RThXbTgvcm8wK2tMTktOcFVvTDFTSWVyQk55Y1BrRUFkNGc1MmJscmxLS0NIT2w1UnhUWFU2Y1JmQnhZMUtPMnhjWEtjTkFkamU5SmVEVDlUT3c3T292N2pVR1NPUm9naXJ4R29HQlBCMEFKZHdLaGZUUEhNbmFSUDJNOUhIdlBtRzE4Z0QxN2VjT0xUMjRlb3JQV2FpdXRHTFc1Y2xjWmlvSnd1L2MzM0ZibGt6TlVhdjR2NXZpU1dWSFpuTDk5V0draGc2OUFFTVZsOXBTNHRQYVhvS3FLQW56SE0xVUswZGdmVm9HQUdpL21zZyt0Y0tCR2JuUFZCTTNYZ2JRMHd6azV3UVdEMUlNczQrZ2JsUEhCb3lwNis5cnFOQ081clJ5WlBMRjcwU3dBY3RxMDMzSW9ndWE5RnFodlBEb1lGNlZUWjNGMkdxNjJZZDNLZjBPR0Z6WlBpdzVEcTk1TUc4eDBSVDh6bnNMRWllT0VzRzVHemlISGZON0FLcTRBN3lqd21TM2JBU3poSjBpcWxib3BaaVRieWNsLzJnQVpuRUpRV1hnM3QyM20vSmhLSmNqNUVEd3VQNEdzQnRQeUxnSkR4a1J3WURZUUh6ZjFjLzc2NWtIUmEzZTE0elFPaUdQZHowK0tobHpRNzRoYW1kb1h3VnJzYW5SYXduT3dtM1Y2VmVjY0dSOTBmVnM4TGY2VnVLRVJBRHdNSzdtNForUzEySUptazFKQ1cvTC9jMD2pdGltZXN0YW1w2gPMZ3FsemFXZHVZWFIxY21YYUFxeElTbHBYTkVnMlFsWkdNemxSV2xvelVYRTBibEpuWlRJMU1rcFhVVXgzUlZoeWIyNVRVbUl3U0ZGb1lYUmxUMGRRWTFWSFRsUkdibWRPTDBSTU4xcHdPREE0TnpKVEwwWnBORlpoZUhscVREZGlhV2t4UjFjMWRUaEZZaTkxUm5FNFVWWjBTV1JzWjFKNlpYVkxlVTFJZFdOQ1NGa3dRbU0zVUdOc05GQjVlRFI0YTJ4SVJsbExURFZuY25WcFUyUmtlbU5rZFdOUmJFVlRZeXM1TkhsRFJtMVhhVTVMTkc4eGFsRjJaRlJFWkVWd05qZEtla3d3Tm5WbVdXeEZiV2xPUVZoaFQwZEVURVp0VFN0WmFYSlpVblJoU0RselZWa3JkRzUzYURKcVdFeE1OM1ZOVVRWUVMyZ3ljbFl6Ymt4aFIzSlpkRkV2TkZKaFVubG9WRWh4Tm5aNVIyeERWWGx0U3pSSWNFTlRaalJ6VDB0WFkxQlhRbHAwVTFoTWMzWkxNMGRNYm5sMVEwWXJXV0puTUM5elowbEdPVlUzTjFoV1RUWXZVRGd4T1ROQ1dVcDBVbFpNTHpSbk5qZzFZMEZzYmtGUkwwMUhPVEZ2VVZReFZrNWpSSHBCZG0xSk5FSkxWRVJxYzNCWFprWkVUMVJ3ZWxORWRWTTBTR04xU2pGVmRVZENXVkJNWW01SWVIQkRkVzlzWWpBNGJrSXpkMWNyYzNwVlVrZGhiQzlIT0VOT04xRlBjR3hQT0Uwd1dGQk1aR2hJVVRndk0yOWlaV3RSWm0xSmVrd3ZUWGhRWlZwd2IwNXdMMGxGZEVKVlZUQTRNMk55VjFvd2FYSjNaSFZUZGtKaFZXeFdhVEJoVEd4clltcFBjMmswYkZoUlR6bHdlVWg0UmxCb2JtMVZUa1Z3Y0hNNVFWVkNVbmw2Ym10WFlraEZRU3RPTVRaUlZHNXlUa1k1WmpCbVFWZE5jRmg2VDIwMmJIRTRjbkpFUjNoNE9GcGhPVXhPVTNveU4wTmFWRXc1TDFWT1NUZGpaU3RtT0ZVNE56WnRVbWhKTjBrMlJrcE9jbEJHYmtoemRHOXpOV3BWWmt4RU1WRTNNMnhYVkhsMVlqazNPVU00V21ObE5USnBlVUZtUzNReGJFVk9NSGxsUWxCelJGTnlkWE51VEZkRE5HaE1VM1l6UkZvMlQyczFWVzgzUzNZNWF6MnBkR2x0WlhOMFlXMXdzakUxTVRFek5UWXlPRE11TWpJM01EY3dPQT09 | QgO46Himh8a5fLBmZ1ypIJLj+cMXKyyxXYb2n50dlNCvUPj2wJMjycLK/dGG3tFgYnqpa9zDgBySkMCKjiksoxHvBbDEau2usXXdcaPKGGUB3+fReQTEnGTIjnHK7X9PleNlyMBpajveDPN8NgR1/Ir11nJeCmRwwvQmWg1jlXncN1aLbKiW37CXwI6J0M/obC4wfAprxPCaM9A696ohJe5mGLqBKlb97c4WTm1w5SjYuyHH4OPUVLJunKpHs5zHg6F9x6Pu2OEqSCma7OJlfy7s2n9vhpSfMNFn+HuzUkOerieF9XEkBFjW/0fSzJNVCRmXZo5dGTduG2qeeo38tAIDl8ZUXjsi1nye2sCugkvXxSXP4DlYljLK8oOwe2p+qkBxl/XlVOD3mH7/yYLCG1xeDm0hmb210ttiNUqqo3BQ30DfCBb9aJjJo6sd4f2ZM7L3ETF7ecXvSGUXPyLfd3MdKMmP0JDOasJ8pBlLSrA3JJ8eY/YzqyuDm2F4IQUSQ7QoX6C0z4ldxwHiAJltlqtFdwnoO1ivPYjxIBxnYnZB1BjNT0GP0c0p1QDgJPTPG+boq44Z8Sel1n0zdTTlJH1gfJQYsxHZyFKeK+mt4wydP+d2Umm3j8dW7jcFtFvYdBqPjHysUpqC1297T7A088C6CXfmwHHHDMmMS8CXQQrp7t4f6OEdIMAfrEad44GZjZwmU2nA0pr5GThFpFXPKnna27Nl79CH15qlPH9KJBpIh1QCNzaxbNi0g/O70XA7VxZP+9OWc0Dy1i0EKUUPvA== |